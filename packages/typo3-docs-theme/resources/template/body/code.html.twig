{% if node.raw %}
    {# see the RawDirective for where this is coming from; a refactor is desired to move this onto its own template / renderer #}
    {{ node.value|raw }}
{%- else -%}
    {% if node.caption %}
        <div class="code-block-caption">
            <span class="caption-text">{{ node.caption }}</span>
        </div>
    {%- endif -%}
    <div class="code-block-wrapper" translate="no">
        {% set showLineNumbers = false %}
        {% set startWithLineNumber = 1 %}
        {% if node.startingLineNumber %}
            {% set showLineNumbers = true %}
            {% set startWithLineNumber = node.startingLineNumber %}
        {% endif %}

        {{ node.value | codehighlight(language=node.language, showLineNumbers=showLineNumbers, startWithLineNumber=startWithLineNumber, emphasizeLines=node.emphasizeLines, classes=node.classesString)}}
        <button class="code-block-copy" title="Copy to clipboard"><svg class="code-block-copy-icon" width="24" height="24"><title>Copy to clipboard</title><rect x="8" y="8" width="12" height="12" rx="2"></rect><path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path></svg></button>
    </div>
{%- endif -%}
