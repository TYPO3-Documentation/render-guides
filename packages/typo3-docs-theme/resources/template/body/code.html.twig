{% if node.caption %}
    <div class="code-block-caption">
        <span class="caption-text">{{ renderNode(node.caption) }}</span>
    </div>
{%- endif -%}
<div class="code-block-wrapper" translate="no">
    {% set showLineNumbers = node.startingLineNumber ? true : false %}
    {% set startWithLineNumber = node.startingLineNumber|default(1) %}
    {% set language = node.language|default('plaintext') %}
    {# Map language aliases #}
    {% set languageMap = {'none': 'plaintext', 'text': 'plaintext', 'shell': 'bash', 'console': 'bash'} %}
    {% set language = languageMap[language]|default(language) %}

    <pre class="code-block {{ node.classesString }}{% if showLineNumbers %} line-numbers{% endif %}"{% if showLineNumbers and startWithLineNumber > 1 %} data-start="{{ startWithLineNumber }}"{% endif %}{% if node.emphasizeLines %} data-line="{{ node.emphasizeLines }}"{% endif %}><code class="language-{{ language }}">{{ node.value | e }}</code></pre>
    <div class="code-block-actions">

        {%- set gitHubLink = getEditOnGitHubLinkFromPath(node.options.path) -%}
        {%- if (gitHubLink)  %}
            <a href="{{ gitHubLink }}" class="code-block-edit" title="Edit on GitHub">
                <i class="icon fa-brands fa-github"></i>
            </a>
        {%- endif %}
        <button class="code-block-copy" title="Copy to clipboard">
            <i class="icon fa-regular fa-copy code-block-copy-icon"></i>
            <i class="fa-solid fa-check code-block-check-icon code-block-hide"></i>
        </button>
        <span class="code-block-check-tooltip code-block-hide" aria-live="polite">Copied!</span>
    </div>
</div>
